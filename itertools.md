# itertools


## Введение

Основанный на итераторах код обеспечивает лучшие характеристики использования
памяти, чем код, основанный на использовании списков. Поскольку итераторы
не возвращает данные до тех пор, пока они не потребуются, отпадает
необходимиость в хранении всего набора данных в памяти. Такая модель отложенной
обработки сглаживает отрицательное влияние подкачки и других побочных эффектов,
связанных с обработкой больших объёмов данных, на производительность.

### Определение

itertools - стандартный модуль Python, включающий в себя ряд функций,
предназначенных для обработки последовательностей.

itertools относят к функциональным модулям, ведь он был вдохновлён такими
языками программирования, как APL, Haskell, SML.


## Функции

### Бесконечные итераторы

Бесконечные итераторы - бесконечные последовательности, которые имеют паттерн.

Итератор | Аргументы | Результат | Пример
--- | --- | --- | ---
count() | начало, [шаг] | начало, начало+шаг, начало+2\*шаг, ... | `count(10) --> 10 11 12 13 14 ...`
cycle() |  с | с0, с1, ..., с0, с1, ... | `cycle('СТРОКА') --> С Т Р О К А С Т Р О К А`
repeat() | элемент, [количество] | элемент, элемент, ... бесконечно или столько сколько указано в количестве | `repeat(10, 3) --> 10 10 10 10` |

### Итераторы, завершающиеся на кратчайшей входной последовательности

Итератор | Аргументы | Результат | Пример
--- | --- | --- | ---
accumulate() | последовательность, [функция] | начало, начало+шаг, начало+2\*шаг, ... | `accumulate([1, 2, 3, 4, 5]) --> 1 3 6 10 15`
chain() |  p, ..., q | p0, p1, p конечный, ..., q1, ..., q конечный | `chain('abc', 'абв') --> a b c а б в`
chain.from_iterable() | итерационный | p0, p1, p конечный, ..., q1, ..., q конечный | `chain.from_iterable(['abc', 'абв']) --> a b c а б в`

### Комбинационные итераторы

Комбинационные итераторы - последовательности, которые перебирают комбинации.

Итератор | Аргументы | Результат
--- | --- | ---
product() | последовательность, [повторы=1] | декартово произведение, эквивалентное вложенному циклу for
permutations() |  последовательность, [п=1] | кортеж длиной r, все возможные порядки без повторяющихся элементов, позиция важна
combinations_with_replacement() | последовательность, [п=1] | кортеж длиной r, все возможные порядки c повторяющимися элементами, позиция не важна


## Примеры

Ниже представлены примеры фукнций, которые могут часто встречаться.

### Бесконечные итераторы

#### `count()`

Используется, когда необходим вечный цикл со знанием количествa пройденных
итераций.

Ниже представлено сравнение скорости работы скрипта с `count()` и без него.

Без `count()` скорость выполнения составит 0.0007404560001305072 секунды.

 ```python
i = 0
while True:
    if i == 200:
        break
    print(i)
    i += 1
 ```

 С `count()` скорость выполнения составит 0.0006238849996407225 секунды.

 ```python
import itertools
for i in itertools.count(0):
    if i == 200:
        break
    print(i)
 ```


### Комбинационные итераторы

Ниже приведена таблица с примерами комбинационных итераторов.

Пример | Резуьтат
--- | ---
product('abcd', repeat=2) | `aa ab ac ad ba bb bc bd ca cb cc cd da db dc dd`
permutations('abcd', 2) | `ab ac ad ba bc bd ca cb cd da db dc`
combinations('abcd', 2) | `ab ac ad bc bd cd`
combinations_with_replacement('abcd', 2) | `aa ab ac ad bb bc bd cc cd dd`

#### Примеры задач

##### Задача №1

Получить последовательность, состоящую из последовательностей, в которых
первый элемент - масть карты, второй элемент её достоинство.

Решение:

```python
import itertools

dignities = list(map(str, range(1, 11))) + ['валет', 'дама', 'король', 'туз']
suits = ['пики', 'трефы', 'черви', 'бубны']

print(*(itertools.product(suits, dignities)))

"""
Результат:
    ('пики', '1') ('пики', '2') ('пики', '3')
    ('пики', '4') ('пики', '5') ('пики', '6')
    ('пики', '7') ('пики', '8') ('пики', '9')
    ('пики', '10') ('пики', 'валет') ('пики', 'дама')
    ('пики', 'король') ('пики', 'туз') ('трефы', '1')
    ...
    ('бубны', 'дама') ('бубны', 'король') ('бубны', 'туз')
"""
```

##### Задача №2

Решим задание 8 задание ЕГЭ, используя разбираемый модуль.

Задание:
(№ 3538) (Е. Джобс) Все 4-буквенные слова, составленные из букв П, Р, В, Д, А, записаны в алфавитном порядке и пронумерованы. Вот начало списка:

```
1. АААА
2. АААВ
3. АААД
4. АААП
5. АААР
6. ААВА
...
```

Найдите номер первого слова в этом списке, которое не содержит гласных и одинаковых букв.

Решение:

```python
import itertools

seq = 'авдпр'
without_repeat = tuple(itertools.combinations(seq, 4))

for idx, elem in enumerate(itertools.product(seq, repeat=4), 1):
    if 'а' not in elem and elem in without_repeat:
        print(idx, elem)
        break
```
